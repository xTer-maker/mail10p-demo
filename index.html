<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Mail 10 Ph√∫t</title>
<style>
    body { font-family: Arial, sans-serif; text-align: center; background: #f3f4f6; margin: 0; padding: 0; }
    h1 { background: #4f46e5; color: white; padding: 15px; margin: 0; }
    .container { max-width: 700px; margin: auto; padding: 20px; }
    #emailBox { background: white; padding: 10px; border-radius: 8px; border: 1px solid #ccc; font-size: 18px; }
    button { margin-top: 10px; padding: 10px 15px; background: #4f46e5; color: white; border: none; border-radius: 5px; cursor: pointer; }
    button:hover { background: #4338ca; }
    #timer { font-weight: bold; color: red; margin-top: 10px; }
    #inbox { margin-top: 20px; background: white; padding: 10px; border-radius: 8px; border: 1px solid #ccc; max-height: 300px; overflow-y: auto; text-align: left; }
    .mailItem { border-bottom: 1px solid #ddd; padding: 5px; }
</style>
</head>
<body>

<h1>üìß Mail 10 Ph√∫t</h1>
<div class="container">
    <div id="emailBox">ƒêang t·∫°o email...</div>
    <button onclick="copyEmail()">üìã Sao ch√©p</button>
    <div id="timer">Th·ªùi gian c√≤n l·∫°i: 10:00</div>
    <h2>üì® H·ªôp th∆∞</h2>
    <div id="inbox">Ch∆∞a c√≥ email...</div>
</div>

<script>
let email = localStorage.getItem("tempEmail");
let timeLeft = localStorage.getItem("timeLeft") ? parseInt(localStorage.getItem("timeLeft")) : 600;

async function createEmail() {
    const res = await fetch("https://api.mail.tm/accounts", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ address: `user${Date.now()}@developermail.com`, password: "123456" })
    });
    const data = await res.json();
    email = data.address;
    localStorage.setItem("tempEmail", email);
    localStorage.setItem("timeLeft", 600);
    timeLeft = 600;
    document.getElementById("emailBox").textContent = email;
}

function copyEmail() {
    navigator.clipboard.writeText(email);
    alert("ƒê√£ sao ch√©p email!");
}

function updateTimer() {
    if (timeLeft > 0) {
        timeLeft--;
        localStorage.setItem("timeLeft", timeLeft);
    } else {
        createEmail();
    }
    let minutes = Math.floor(timeLeft / 60);
    let seconds = timeLeft % 60;
    document.getElementById("timer").textContent = `Th·ªùi gian c√≤n l·∫°i: ${minutes}:${seconds.toString().padStart(2, '0')}`;
}

async function fetchInbox() {
    document.getElementById("inbox").innerHTML = "<i>ƒêang t·∫£i...</i>";
    const res = await fetch(`https://api.mail.tm/messages`, {
        headers: { Authorization: `Bearer YOUR_TOKEN` }
    });
    const data = await res.json();
    let html = "";
    data["hydra:member"].forEach(msg => {
        html += `<div class="mailItem"><b>${msg.from.address}</b> - ${msg.subject}<br>${msg.intro}</div>`;
    });
    document.getElementById("inbox").innerHTML = html || "Ch∆∞a c√≥ email...";
}

async function init() {
    if (!email) {
        await createEmail();
    } else {
        document.getElementById("emailBox").textContent = email;
    }
    setInterval(updateTimer, 1000);
    fetchInbox();
    setInterval(fetchInbox, 10000);
}

init();
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Email T·∫°m Th·ªùi - GitHub Pages</title>
<style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; text-align: center; padding: 20px; }
    h1 { color: #333; }
    button { padding: 10px 15px; margin: 10px; background: #007BFF; color: white; border: none; cursor: pointer; border-radius: 5px; }
    button:hover { background: #0056b3; }
    #emailBox { font-weight: bold; color: green; }
    table { width: 80%; margin: auto; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background: #eee; }
</style>
</head>
<body>

<h1>üìß Email T·∫°m Th·ªùi</h1>
<p>Email c·ªßa b·∫°n: <span id="emailBox">ƒêang t·∫°o...</span></p>
<button onclick="refreshInbox()">üîÑ L√†m m·ªõi inbox</button>

<table>
<thead>
<tr>
    <th>Ng∆∞·ªùi g·ª≠i</th>
    <th>Ch·ªß ƒë·ªÅ</th>
    <th>N·ªôi dung</th>
</tr>
</thead>
<tbody id="inbox">
<tr><td colspan="3">Ch∆∞a c√≥ email...</td></tr>
</tbody>
</table>

<script>
let token = "";
let emailAddress = "";
let userId = "";

async function createEmail() {
    const domainRes = await fetch("https://api.mail.tm/domains");
    const domains = await domainRes.json();
    const domain = domains["hydra:member"][0].domain;

    const randomName = "user" + Math.floor(Math.random() * 10000);
    emailAddress = randomName + "@" + domain;

    const password = "pass" + Math.random().toString(36).substring(2);

    await fetch("https://api.mail.tm/accounts", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ address: emailAddress, password: password })
    });

    const tokenRes = await fetch("https://api.mail.tm/token", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ address: emailAddress, password: password })
    });
    const tokenData = await tokenRes.json();
    token = tokenData.token;

    document.getElementById("emailBox").innerText = emailAddress;
}

async function refreshInbox() {
    if (!token) return alert("Email ch∆∞a ƒë∆∞·ª£c t·∫°o!");
    const res = await fetch("https://api.mail.tm/messages", {
        headers: { Authorization: "Bearer " + token }
    });
    const data = await res.json();
    const inbox = document.getElementById("inbox");
    inbox.innerHTML = "";

    if (data["hydra:member"].length === 0) {
        inbox.innerHTML = "<tr><td colspan='3'>Ch∆∞a c√≥ email...</td></tr>";
        return;
    }

    data["hydra:member"].forEach(msg => {
        inbox.innerHTML += `
        <tr>
            <td>${msg.from.address}</td>
            <td>${msg.subject}</td>
            <td>${msg.intro}</td>
        </tr>
        `;
    });
}

createEmail();
</script>

</body>
</html>
